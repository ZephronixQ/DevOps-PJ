# Security Context

**Security Context** позволяет задать параметры, контролирующие права и возможности контейнеров в Kubernetes, что помогает повысить безопасность контейнеров и защитить их от потенциальных угроз.

## Основные параметры

- **`runAsUser`**: Определяет пользователя, от имени которого будет работать контейнер. Например, `runAsUser: 1000` указывает, что контейнер будет запущен от пользователя с ID 1000.

  ```yaml
  runAsUser: 1000
  ```

- **`runAsNonRoot`**: Запрещает запуск контейнера от имени пользователя root. Установка этого параметра в `true` предотвращает запуск контейнера от root-пользователя.

  ```yaml
  runAsNonRoot: true
  ```

- **`readOnlyRootFilesystem`**: Устанавливает файловую систему корня в режим только для чтения, что предотвращает запись на диск. Это повышает безопасность, предотвращая изменение критичных файлов.

  ```yaml
  readOnlyRootFilesystem: true
  ```

- **`allowPrivilegeEscalation`**: Если установлено в `false`, запрещает контейнерам повышать привилегии, например, переходить на root-пользователя. Это помогает защитить контейнеры от потенциальных атак.

  ```yaml
  allowPrivilegeEscalation: false
  ```

## Мандаты (Capabilities)

- **`drop`**: Удаляет все привилегии (capabilities) у контейнера. Это помогает минимизировать привилегии, доступные контейнеру, и снизить риск безопасности.

  ```yaml
  capabilities:
    drop:
    - "all"
  ```

- **`add`**: Добавляет необходимые привилегии, если они нужны для работы контейнера. Рекомендуется добавлять только те привилегии, которые действительно необходимы.

  ```yaml
  capabilities:
    add:
    - "NET_ADMIN"
  ```

## Пример конфигурации Pod

```yaml
apiVersion: v1
kind: Pod
metadata:
  name: secure-pod
spec:
  securityContext:
    runAsUser: 1000
    runAsNonRoot: true
    readOnlyRootFilesystem: true
    allowPrivilegeEscalation: false
    capabilities:
      drop:
      - "all"
      add:
      - "NET_ADMIN"
  containers:
  - name: my-container
    image: my-image
    securityContext:
      capabilities:
        add:
        - "SYS_TIME"
```

## Заключение

**Security Context** является важным инструментом для управления безопасностью контейнеров в Kubernetes. Он позволяет задавать параметры, которые контролируют права и возможности контейнеров, помогая защитить их от потенциальных угроз и атак.

Настройка параметров, таких как `runAsUser`, `runAsNonRoot`, `readOnlyRootFilesystem` и `allowPrivilegeEscalation`, а также управление привилегиями с помощью `capabilities`, позволяет улучшить безопасность контейнеров, минимизировать риски и обеспечить соблюдение лучших практик по безопасности.

Использование Security Context помогает создать более защищенное и надежное окружение для запуска контейнеров, поддерживая целостность и безопасность приложений в вашем Kubernetes-кластере.

